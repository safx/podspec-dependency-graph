(function(){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.misc"),sigma.misc.bindEvents=function(t){function e(e){e&&(d="x"in e.data?e.data.x:d,o="y"in e.data?e.data.y:o);var n,i,s,c,h,r,l,u,f=[],g=d+a.width/2,p=o+a.height/2,v=a.camera.cameraPosition(d,o),m=a.camera.quadtree.point(v.x,v.y);if(m.length)for(n=0,s=m.length;s>n;n++)if(c=m[n],h=c[t+"x"],r=c[t+"y"],l=c[t+"size"],!c.hidden&&g>h-l&&h+l>g&&p>r-l&&r+l>p&&Math.sqrt(Math.pow(g-h,2)+Math.pow(p-r,2))<l){for(u=!1,i=0;i<f.length;i++)if(c.size>f[i].size){f.splice(i,0,c),u=!0;break}u||f.push(c)}return f}function n(t){function n(t){a.settings("eventsEnabled")&&(a.dispatchEvent("click",t.data),d=e(t),d.length?(a.dispatchEvent("clickNode",{node:d[0]}),a.dispatchEvent("clickNodes",{node:d})):a.dispatchEvent("clickStage"))}function i(){if(a.settings("eventsEnabled")){var t,e,n,i=[];for(t in o)i.push(o[t]);for(o={},e=0,n=i.length;n>e;e++)a.dispatchEvent("outNode",{node:i[e]});i.length&&a.dispatchEvent("outNodes",{nodes:i})}}function s(t){if(a.settings("eventsEnabled")){d=e(t);var n,i,s,c=[],h=[],r={},l=d.length;for(n=0;l>n;n++)s=d[n],r[s.id]=s,o[s.id]||(h.push(s),o[s.id]=s);for(i in o)r[i]||(c.push(o[i]),delete o[i]);for(n=0,l=h.length;l>n;n++)a.dispatchEvent("overNode",{node:h[n]});for(n=0,l=c.length;l>n;n++)a.dispatchEvent("outNode",{node:c[n]});h.length&&a.dispatchEvent("overNodes",{nodes:h}),c.length&&a.dispatchEvent("outNodes",{nodes:c})}}var d,o={};t.bind("click",n),t.bind("mouseup",s),t.bind("mousemove",s),t.bind("mouseout",i),a.bind("render",s)}var i,s,d,o,a=this;for(i=0,s=this.captors.length;s>i;i++)n(this.captors[i])}}).call(this);