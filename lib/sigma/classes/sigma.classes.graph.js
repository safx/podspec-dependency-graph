(function(){"use strict";function e(e,t,r){var s=function(){var s,i;i=r.apply(t,arguments);for(s in n[e])n[e][s].apply(t,arguments);return i};return s}function t(e){var t;for(t in e)"hasOwnProperty"in e&&!e.hasOwnProperty(t)||delete e[t];return e}var r=Object.create(null),s=Object.create(null),i=Object.create(null),n=Object.create(null),o={immutable:!0,clone:!0},d=function(e){return o[e]},h=function(t){var s,n,o;o={settings:t||d,nodesArray:[],edgesArray:[],nodesIndex:Object.create(null),edgesIndex:Object.create(null),inNeighborsIndex:Object.create(null),outNeighborsIndex:Object.create(null),allNeighborsIndex:Object.create(null),inNeighborsCount:Object.create(null),outNeighborsCount:Object.create(null),allNeighborsCount:Object.create(null)};for(s in i)i[s].call(o);for(s in r)n=e(s,o,r[s]),this[s]=n,o[s]=n};h.addMethod=function(e,t){if("string"!=typeof e||"function"!=typeof t||2!==arguments.length)throw"addMethod: Wrong arguments.";if(r[e])throw'The method "'+e+'" already exists.';return r[e]=t,n[e]=Object.create(null),this},h.attach=function(e,t,r){if("string"!=typeof e||"string"!=typeof t||"function"!=typeof r||3!==arguments.length)throw"attach: Wrong arguments.";var s;if("constructor"===e)s=i;else{if(!n[e])throw'The method "'+e+'" does not exist.';s=n[e]}if(s[t])throw'A function "'+t+'" is already attached to the method "'+e+'".';return s[t]=r,this},h.addIndex=function(e,t){if("string"!=typeof e||Object(t)!==t||2!==arguments.length)throw"addIndex: Wrong arguments.";if(s[e])throw'The index "'+e+'" already exists.';var r;s[e]=t;for(r in t){if("function"!=typeof t[r])throw"The bindings must be functions.";h.attach(r,e,t[r])}return this},h.addMethod("addNode",function(e){if(Object(e)!==e||1!==arguments.length)throw"addNode: Wrong arguments.";if("string"!=typeof e.id)throw"The node must have a string id.";if(this.nodesIndex[e.id])throw'The node "'+e.id+'" already exists.';var t,r=e.id,s=Object.create(null);if(this.settings("clone"))for(t in e)"id"!==t&&(s[t]=e[t]);else s=e;return this.settings("immutable")?Object.defineProperty(s,"id",{value:r,enumerable:!0}):s.id=r,this.inNeighborsIndex[r]=Object.create(null),this.outNeighborsIndex[r]=Object.create(null),this.allNeighborsIndex[r]=Object.create(null),this.inNeighborsCount[r]=0,this.outNeighborsCount[r]=0,this.allNeighborsCount[r]=0,this.nodesArray.push(s),this.nodesIndex[s.id]=s,this}),h.addMethod("addEdge",function(e){if(Object(e)!==e||1!==arguments.length)throw"addEdge: Wrong arguments.";if("string"!=typeof e.id)throw"The edge must have a string id.";if("string"!=typeof e.source||!this.nodesIndex[e.source])throw"The edge source must have an existing node id.";if("string"!=typeof e.target||!this.nodesIndex[e.target])throw"The edge target must have an existing node id.";if(this.edgesIndex[e.id])throw'The edge "'+e.id+'" already exists.';var t,r=Object.create(null);if(this.settings("clone"))for(t in e)"id"!==t&&"source"!==t&&"target"!==t&&(r[t]=e[t]);else r=e;return this.settings("immutable")?(Object.defineProperty(r,"id",{value:e.id,enumerable:!0}),Object.defineProperty(r,"source",{value:e.source,enumerable:!0}),Object.defineProperty(r,"target",{value:e.target,enumerable:!0})):(r.id=e.id,r.source=e.source,r.target=e.target),this.edgesArray.push(r),this.edgesIndex[r.id]=r,this.inNeighborsIndex[e.target][e.source]||(this.inNeighborsIndex[e.target][e.source]=Object.create(null)),this.inNeighborsIndex[e.target][e.source][e.id]=e,this.outNeighborsIndex[e.source][e.target]||(this.outNeighborsIndex[e.source][e.target]=Object.create(null)),this.outNeighborsIndex[e.source][e.target][e.id]=e,this.allNeighborsIndex[e.source][e.target]||(this.allNeighborsIndex[e.source][e.target]=Object.create(null)),this.allNeighborsIndex[e.source][e.target][e.id]=e,this.allNeighborsIndex[e.target][e.source]||(this.allNeighborsIndex[e.target][e.source]=Object.create(null)),this.allNeighborsIndex[e.target][e.source][e.id]=e,this.inNeighborsCount[e.target]++,this.outNeighborsCount[e.source]++,this.allNeighborsCount[e.target]++,this.allNeighborsCount[e.source]++,this}),h.addMethod("dropNode",function(e){if("string"!=typeof e||1!==arguments.length)throw"dropNode: Wrong arguments.";if(!this.nodesIndex[e])throw'The node "'+e+'" does not exist.';var t,r,s;for(delete this.nodesIndex[e],t=0,s=this.nodesArray.length;s>t;t++)if(this.nodesArray[t].id===e){this.nodesArray.splice(t,1);break}for(t=this.edgesArray.length-1;t>=0;t--)(this.edgesArray[t].source===e||this.edgesArray[t].target===e)&&this.dropEdge(this.edgesArray[t].id);delete this.inNeighborsIndex[e],delete this.outNeighborsIndex[e],delete this.allNeighborsIndex[e],delete this.inNeighborsCount[e],delete this.outNeighborsCount[e],delete this.allNeighborsCount[e];for(r in this.nodesIndex)delete this.inNeighborsIndex[r][e],delete this.outNeighborsIndex[r][e],delete this.allNeighborsIndex[r][e];return this}),h.addMethod("dropEdge",function(e){if("string"!=typeof e||1!==arguments.length)throw"dropEdge: Wrong arguments.";if(!this.edgesIndex[e])throw'The edge "'+e+'" does not exist.';var t,r,s;for(s=this.edgesIndex[e],delete this.edgesIndex[e],t=0,r=this.edgesArray.length;r>t;t++)if(this.edgesArray[t].id===e){this.edgesArray.splice(t,1);break}return delete this.inNeighborsIndex[s.target][s.source][s.id],Object.keys(this.inNeighborsIndex[s.target][s.source]).length||delete this.inNeighborsIndex[s.target][s.source],delete this.outNeighborsIndex[s.source][s.target][s.id],Object.keys(this.outNeighborsIndex[s.source][s.target]).length||delete this.outNeighborsIndex[s.source][s.target],delete this.allNeighborsIndex[s.source][s.target][s.id],Object.keys(this.allNeighborsIndex[s.source][s.target]).length||delete this.allNeighborsIndex[s.source][s.target],delete this.allNeighborsIndex[s.target][s.source][s.id],Object.keys(this.allNeighborsIndex[s.target][s.source]).length||delete this.allNeighborsIndex[s.target][s.source],this.inNeighborsCount[s.target]--,this.outNeighborsCount[s.source]--,this.allNeighborsCount[s.source]--,this.allNeighborsCount[s.target]--,this}),h.addMethod("kill",function(){this.nodesArray.length=0,this.edgesArray.length=0,delete this.nodesArray,delete this.edgesArray,delete this.nodesIndex,delete this.edgesIndex,delete this.inNeighborsIndex,delete this.outNeighborsIndex,delete this.allNeighborsIndex,delete this.inNeighborsCount,delete this.outNeighborsCount,delete this.allNeighborsCount}),h.addMethod("clear",function(){return this.nodesArray.length=0,this.edgesArray.length=0,t(this.nodesIndex),t(this.edgesIndex),t(this.nodesIndex),t(this.inNeighborsIndex),t(this.outNeighborsIndex),t(this.allNeighborsIndex),t(this.inNeighborsCount),t(this.outNeighborsCount),t(this.allNeighborsCount),this}),h.addMethod("read",function(e){var t,r,s;for(r=e.nodes||[],t=0,s=r.length;s>t;t++)this.addNode(r[t]);for(r=e.edges||[],t=0,s=r.length;s>t;t++)this.addEdge(r[t]);return this}),h.addMethod("nodes",function(e){if(!arguments.length)return this.nodesArray.slice(0);if(1===arguments.length&&"string"==typeof e)return this.nodesIndex[e];if(1===arguments.length&&"[object Array]"===Object.prototype.toString.call(e)){var t,r,s=[];for(t=0,r=e.length;r>t;t++){if("string"!=typeof e[t])throw"nodes: Wrong arguments.";s.push(this.nodesIndex[e[t]])}return s}throw"nodes: Wrong arguments."}),h.addMethod("degree",function(e,t){if(t={"in":this.inNeighborsCount,out:this.outNeighborsCount}[t||""]||this.allNeighborsCount,"string"==typeof e)return t[e];if("[object Array]"===Object.prototype.toString.call(e)){var r,s,i=[];for(r=0,s=e.length;s>r;r++){if("string"!=typeof e[r])throw"degree: Wrong arguments.";i.push(t[e[r]])}return i}throw"degree: Wrong arguments."}),h.addMethod("edges",function(e){if(!arguments.length)return this.edgesArray.slice(0);if(1===arguments.length&&"string"==typeof e)return this.edgesIndex[e];if(1===arguments.length&&"[object Array]"===Object.prototype.toString.call(e)){var t,r,s=[];for(t=0,r=e.length;r>t;t++){if("string"!=typeof e[t])throw"edges: Wrong arguments.";s.push(this.edgesIndex[e[t]])}return s}throw"edges: Wrong arguments."}),"undefined"!=typeof sigma?(sigma.classes=sigma.classes||Object.create(null),sigma.classes.graph=h):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports.graph=h):this.graph=h}).call(this);